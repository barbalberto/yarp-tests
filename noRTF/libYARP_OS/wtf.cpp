/*
 * Copyright (C) 2017 iCub Facility
 * Authors: Alberto Cardellino
 * CopyPolicy: Released under the terms of the LGPLv2.1 or later, see LGPL.TXT
 *
 */

#include <fstream>
#include <string>
#include <cstdio>
#include <deque>
#include <ostream>      // std::cout, std::fixed
#include <iostream>     // std::cout, std::fixed
#include <iomanip>      // std::setprecision


#include <yarp/os/all.h>
#include <yarp/os/RateThread.h>
#include <yarp/os/Time.h>
#include <yarp/os/RFModule.h>

#include <yarp/dev/all.h>
#include <yarp/sig/all.h>


#include <float.h>

using namespace yarp::os;
using namespace yarp::dev;
using namespace yarp::sig;

std::string leftFuck = {
  "                                                                                              \n"
  "                                         `+yyyyyyyys:                                         \n"
  "                                        +d+./ooooo:-sd:                                       \n"
  "                                       +d.+y:````.+y:-m/                                      \n"
  "                                       N/+y````````.h:/m`                                     \n"
  "                                      .M.m.`````````-d.N:                                     \n"
  "                                      :N.h/.```````./d.ho                                     \n"
  "                                      /m`.:oo+///+oo/.`ys                                     \n"
  "                                      /m```..-----..```ys                                     \n"
  "                                      /m```````````````ho                                     \n"
  "                                      :m```````````````d+                                     \n"
  "                                      :N`````..--.`````d/                                     \n"
  "                                      -N..-/+++//--.```m/                                     \n"
  "                                      :N`./-.+++//:.``.m:                                     \n"
  "                                      /m```````````````m/                                     \n"
  "                                      oh```````````````d+                                     \n"
  "                                      ys```````````````hs                                     \n"
  "                                 ```  do```````````````sy                                     \n"
  "                              -+sssss/N/```````````````oh                                     \n"
  "                            :ys:.``.-+M-```````````````+m                                     \n"
  "                          -yy-```````-M.```````````````:N                                     \n"
  "                        .sh:`````````:N````````.```````-M`                                    \n"
  "                      .oh+.....-...``/m``..-:+++++:.```.N-                                    \n"
  "                    -sh/.-+ssssossyo:+d``:+/:...-://.```m/.:+oo+/:`                           \n"
  "                  .yh:.-yy/.``````.:smh``/++++++/:++.```dms+:--:/+sy+`  ``                    \n"
  "                 od:`.od:````````````oh``-++++++++++:```ys`````````.odhsssyy+`                \n"
  "               .do.`.yy.`````````````sy```````..````````sy```````````:m:```./hs.              \n"
  "              :m:```oh.``````````````sy`````````````````oh````````````+d.````.:hs`            \n"
  "             +d-```.N:```````````````ss`````````````````oh````````````.m/``````.sh`           \n"
  "            /m-````+d.```````````````yo`````````````````oh`````````````oh```````.yy           \n"
  "           -N:`````d+````````````````d+`````````````````sy`````````````-N.```````.d+          \n"
  "           hs`````-N.````````````````m:`````````````````yy`````````````.m/````````:N.         \n"
  "          `M-`````oh````````````````.N-`````````````````ys``````````````ho`````````yy         \n"
  "          `M-`````ho````````````````:N.`````````````````ho``````````````sy`````````:N`        \n"
  "           do`````m/````````````````+d``````````````````d+``````````````+d`````````.N-        \n"
  "           :m.```.N-````````````````ys``````````````````m/``````````````:N.````````.N-        \n"
  "            hs```-M.```````````````.m/``````````````````N:``````````````-M.````````.N:        \n"
  "            .N:`:hM.```````````````:N.`````````````````.N-``````````````.M.````````.N-        \n"
  "             oh.+:M.``````````````.sy``````````````````.N:``````````````-N.````````.M.        \n"
  "             `m+`.y.`````````````-sN:```````````````````m/``````````````+N.````````:N`        \n"
  "              /m.````````````````.-/````````````````````oh.````````````.dd-````````od         \n"
  "               do```````````````````````````````````````./.````````````.:..````````ho         \n"
  "               :m.```````````````````````````````````````````````````````````````.+m.         \n"
  "                m/``````````````````````````````````````````````````````````````.sy.          \n"
  "                oh.````````````````..`````````````````````````````````````````.:h+            \n"
  "                `m/````````````````+y``````````````````````````````..````````-sh-             \n"
  "                 :m-```````````````yy``````````````````.:.`````````h+`````..oh/               \n"
  "                  +d:..````````````yy``````````````````:N-```````.-N:``..-oh+`                \n"
  "                   :sys+/:--..---:/dy`````````````````.+o``````.-omd+++sys:                   \n"
  "                      .:/+oooooo++/od+..````````````.-sh+:---/oyy/`.-:-`                      \n"
  "                                    `ohs/.........:ohs-`:+ooo/-`                              \n"
  "                                       -+syyyyyyys+-                                          \n"
  "                                                                                              \n"
  "                                                                                              \n"};

std::string rightFuck = {
"                                             :syyyyyyyy+`                                          \n\
                                            :ds-:ooooo/.+d+                                         \n\
                                          /m-:y+.````:y+.d+                                         \n\
                                         `m/:h.````````y+/N                                         \n\
                                         :N.d-`````````.m.M.                                        \n\
                                         oh.d/.```````./h.N:                                        \n\
                                         sy`./oo+///+oo:.`m/                                        \n\
                                         sy```..-----..```m/                                        \n\
                                         oh```````````````m/                                        \n\
                                         +d```````````````m:                                        \n\
                                         /d`````.--..`````N:                                        \n\
                                         /m```.--//+++/-..N-                                        \n\
                                         :m.``.://+++.-/.`N:                                        \n\
                                         /m```````````````m/                                        \n\
                                         +d```````````````ho                                        \n\
                                         sh```````````````sy                                        \n\
                                         ys```````````````od  ```                                   \n\
                                         ho```````````````/N/sssss+-                                \n\
                                         m+```````````````-M+-.``.:sy:                              \n\
                                         N:```````````````.M-```````-yy-                            \n\
                                        `M-```````.````````N:`````````:hs.                          \n\
                                        -N.```.:+++++:-..``m/``...-.....+ho.                        \n\
                               `:/+oo+:./m```.//:-...:/+:``d+:oyssossss+-./hs-                      \n\
                        ``  `+ys+/:--:+smd```.++:/++++++/``hms:.``````./yy-.:hy.                    \n\
                    `+yyssshdo.`````````sy```:++++++++++-``ho````````````:do.`:do                   \n\
                  .sh/.```:m:```````````ys````````..```````ys`````````````.yy.`.od.                 \n\
                `sh:.````.d+````````````ho`````````````````ys``````````````.ho```:m:                \n\
               `hs.``````/m.````````````ho`````````````````ss```````````````:N.```-d+               \n\
               yy.```````ho`````````````ho`````````````````oy```````````````.d+````-m/              \n\
              +d.```````.N-`````````````ys`````````````````+d````````````````+d`````:N-             \n\
             .N:````````/m.`````````````yy`````````````````:m````````````````.N-`````sh             \n\
             yy`````````oh``````````````sy`````````````````-N.````````````````ho`````-M`            \n\
            `N:`````````ys``````````````oh`````````````````.N:````````````````oh`````-M`            \n\
            -N.`````````d+``````````````+d``````````````````d+````````````````/m`````od             \n\
            -N.````````.N:``````````````/m``````````````````sy````````````````-N.```.m:             \n\
            :N.````````.M-``````````````:N``````````````````/m.```````````````.M-```sh              \n\
            -N.````````.M.``````````````-N.`````````````````.N:```````````````.Mh:`:N.              \n\
            .M.````````.N-``````````````:N.``````````````````ys.``````````````.M:+.ho               \n\
            `N:````````.N+``````````````/m```````````````````:Ns-`````````````.y.`+m`               \n\
             do````````-dd.````````````.ho````````````````````/-.````````````````.m/                \n\
             oh````````..:.````````````./.```````````````````````````````````````od                 \n\
             .m+.```````````````````````````````````````````````````````````````.m:                 \n\
              .ys.``````````````````````````````````````````````````````````````/m                  \n\
                +h:.`````````````````````````````````````````..````````````````.ho                  \n\
                 -hs-````````..``````````````````````````````y+````````````````/m`                  \n\
                   /ho..`````+h`````````.:.``````````````````yy```````````````-m:                   \n\
                    `+ho-..``:N-.```````-N:``````````````````yy````````````..:d+                    \n\
                       :sys+++dmo-.``````o+.`````````````````yd/:---..--:/+sys:                     \n\
                          `-:-.`/yyo/---:+hs-.````````````..+do/++oooooo+/:.                        \n\
                                  `-/ooo+:`-sho:........./sho`                                      \n\
                                              -+syyyyyyys+-                                         \n\
                                                                                                    \n\
                                                                                                    \n"};
/**************** Thread ***********************/
class wtf : public RFModule
{
private:
    Bottle data, data2;
    Port   port;
    Port   port2;
    bool   toggle;
    bool verbose;

public:

    wtf(bool system=true)  : toggle(false), verbose(false) {  }

    bool configure(yarp::os::ResourceFinder &rf)
    {
        port.open("/wtf");
        if(rf.check("verbose"))
            verbose = true;
        return true;
    }

    double getPeriod()
    {
        return 0.6;
    }


    bool updateModule()
    {
        data.clear();
        if(toggle)
        {
            data.addString(leftFuck);
            if(verbose) printf("%s", leftFuck.c_str());
        }
        else
        {
            data.addString(rightFuck);
            if(verbose) printf("%s", rightFuck.c_str());
        }
        toggle = !toggle;
//         port.setOutputMode(true);
        port.write(data);
//         port2.read(data2);

//         printf("%s\n", data2.get(0).toString().c_str());
        return true;
    }

    bool interruptModule()
    {
        yTrace();
        return true;
    }
};

/***********************************************/
int main(int argc, char *argv[])
{
    // initialize yarp with system clock
    yarp::os::Network yarp(/*YARP_CLOCK_SYSTEM*/);
    if(!yarp::os::Network::checkNetwork())
        return -1;

    ResourceFinder rf;
    rf.configure(argc, argv);
    wtf RFTest;
    RFTest.runModule(rf);
    return 0;
}


